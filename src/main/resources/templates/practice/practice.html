<!DOCTYPE html>
<html th:replace="~{general:: layout(~{::main})}">
    <head>
        <title>SQL-junailija</title>
    </head>
    <body>

        <main class="content">

            <div class="mdl-cell--12-col">

                <h4>You are currently practicing!</h4>

                <p><strong>Topic name</strong>: <span th:text="${exercise.topic.name}">name</span></p>

                <p><strong>Exercise name</strong>: <span th:text="${exercise.name}">name</span></p>

                <p><strong>Exercise handout</strong>:</p>

                <p th:text="${exercise.handout}">
                    handout
                </p>

                <p>
                    <strong>Database name:</strong> <span th:text="${exercise.database.name}">name</span><br/><a th:href="@{/databases/{databaseId}(databaseId=${exercise.database.id})}" target="_blank">View database description (by clicking this link).</a>
                </p>

                <p>
                    <a th:href="@{/practice/topics/{topicId}/exercises/{exerciseId}/expected(topicId=${exercise.topic.id},exerciseId=${exercise.id})}" target="_blank">View expected outcome.</a>
                </p>

                <div class="alert alert-danger" th:if="${errors}">
                    <h4>Your submission was not correct. This automatic output from the system might help you to solve the issue:</h4>
                    <ul>
                        <li th:each="err : ${errors}" th:text="${err}">Errors</li>    
                    </ul>

                </div>

                <div th:if="${queryResultTable != null}">
                    <p><strong>Table generated by your submission</strong>:</p>    

                    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
                        <tr>
                            <th class="mdl-data-table__cell--non-numeric" th:each="header: ${queryResultTable.headers}" th:text="${header}">header</th>
                        </tr>
                        <tr th:each="rowMap: ${queryResultTable.data}">
                            <td class="mdl-data-table__cell--non-numeric" th:each="header: ${queryResultTable.headers}" th:text="${rowMap.get(header)}">content</td>
                        </tr>
                    </table>
                </div>

                <p><strong>Type in your solution here</strong>:</p>


                <form method="POST" th:action="@{/practice/topics/{topicId}/exercises/{exerciseId}(topicId=${exercise.topic.id},exerciseId=${exercise.id})}">

                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-cell--12-col">
                        <textarea class="mdl-textfield__input" type="text" rows="16" name="sqlCommands" id="sqlCommands" th:text="${sqlCommands}" onkeydown="tab(this, event);"></textarea>
                        <label class="mdl-textfield__label" for="sqlCommands">SQL Statements needed to solve the problem</label>
                    </div>

                    <input type="submit" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" value="Submit solution!"></input>

                </form>

                <div th:if="${attempts?.size() > 0}">
                    <h4>Previous attempts</h4>

                    <ul>
                        <li th:each="attempt: ${attempts}">
                            Attempt <span th:text="${attemptStat.index + 1}">index</span>: <span th:text="${#temporals.format(attempt.created,'dd.MM.yyyy HH:mm')}">time</span>, 
                            correct: <span th:text="${attempt.correct}">attempt correct</span>. <a th:href="@{/practice/topics/{topicId}/exercises/{exerciseId}/attempts/{attemptId}(topicId=${attempt.exercise.topic.id},exerciseId=${attempt.exercise.id},attemptId=${attempt.id})}">Click here to view attempt</a>.</li>
                    </ul>
                </div>

            </div>


        </main>

    </body>
</html>
